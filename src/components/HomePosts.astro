---
import { getCollection } from "astro:content";
import { date, datetimeRegex, defaultErrorMap } from "astro:schema";
const allPost = await getCollection("blog");
const posts = (await getCollection("blog")).sort(
    (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);
---

<section class="my-16 flex flex-col justify-center">
    <div
        class="w-full max-w-7xl mx-auto px-4 flex flex-col items-start justify-center"
    >
        <h2 class="text-2xl font-bold">Recent Posts</h2>
        <p class="text-sm">// 最近の投稿</p>
        <div class="w-full h-[1px] bg-gray-200 my-8"></div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 w-full">
            {
                posts.map((post) => (
                    <a
                        href=`/blog/${post.id}`
                        class="w-full flex flex-col overflow-hidden rounded-lg border border-gray-200"
                    >
                        <div class="w-full aspect-video bg-gray-200 border-b border-gray-200 flex items-center justify-center">
                            {
                                post.data.image ? <img src={post.data.image} class="w-full h-full object-cover" loading="lazy" /> : <span class="text-gray-500">No Image</span>
                            }
                        </div>
                        <div class="p-4 flex flex-col">
                            <div class="flex flex-row items-center gap-2">
                                <i class="ri-calendar-line" />
                                <p>{post.data.date.toLocaleDateString("ja-JP")}</p>
                            </div>
                            <h3 class="text-lg font-bold line-clamp-2">
                                {post.data.title}
                            </h3>
                            <p class="text-sm text-gray-500 line-clamp-2">
                                {post.data.description}
                            </p>
                        </div>
                    </a>
                ))
            }
        </div>
    </div>
</section>
